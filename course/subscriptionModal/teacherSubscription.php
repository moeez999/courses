 <!-- for teacher -->
 <div class="subscribe-modal-backdrop-for-teachers">
     <div class="subscribe-modal-main">
         <button class="subscribe-modal__close" data-subscribe-close="" aria-label="Close">
             ×
         </button>
         <main class="checkout-page">
             <div class="checkout-container">
                 <section class="plan-selection-panel">
                     <div class="panel-content">
                         <div class="selection-header">
                             <!--merged image-->
                             <div class="header-icon-wrapper">
                                 <img src="../img/subs/Progress-steps.png" alt="">
                             </div>
                             <div class="selection-header-text">
                                 <h2>Time to help you succeed at work!</h2>
                                 <p>Consistency is key to progress, so we recommend a weekly schedule. Each
                                     <b>50-min</b>
                                     lesson costs <b>$9.00</b>.
                                 </p>
                             </div>
                         </div>
                         <div class="plan-options">
                             <div class="plan-option">
                                 <input type="radio" name="teacher-plan" id="teacher-plan-1" class="visually-hidden">
                                 <label for="teacher-plan-1" class="plan-label">
                                     <span class="plan-name">1 lesson
                                         <span class="plan-time">per week</span>

                                     </span>
                                     <span class="plan-price"><b>$36.00</b> every 4 weeks</span>
                                 </label>
                             </div>
                             <div class="plan-option">
                                 <input type="radio" name="teacher-plan" id="teacher-plan-4" class="visually-hidden">
                                 <label for="teacher-plan-4" class="plan-label">
                                     <span class="plan-name">2 lessons
                                         <span class="plan-time">per week</span>

                                     </span>
                                     <span class="plan-price"><b>$72.00</b> every 4 weeks</span>
                                 </label>
                             </div>
                             <div class="plan-option">
                                 <input type="radio" name="teacher-plan" id="teacher-plan-6" class="visually-hidden"
                                     checked="">
                                 <label for="teacher-plan-6" class="plan-label">
                                     <span class="plan-name">3 lesson
                                         <span class="plan-time">per week</span>

                                     </span>
                                     <span class="plan-price"><b>$108.00</b> every 4 weeks</span>
                                 </label>
                             </div>
                             <div class="plan-option">
                                 <input type="radio" name="teacher-plan" id="teacher-plan-9" class="visually-hidden">
                                 <label for="teacher-plan-9" class="plan-label">
                                     <span class="plan-name">4 lesson

                                         <span class="plan-time">per week</span>

                                     </span>
                                     <span class="plan-price"><b>$144.00</b> every 4 weeks</span>
                                 </label>
                             </div>
                             <div class="plan-option">
                                 <input type="radio" name="teacher-plan" id="teacher-plan-12" class="visually-hidden">
                                 <label for="teacher-plan-12" class="plan-label">
                                     <div class="plan-name-wrapper">
                                         <span class="plan-name">5 lesson <span class="plan-time">per
                                                 week</span></span>


                                     </div>
                                     <span class="plan-price"><b>$180.00</b> every 4 weeks</span>
                                 </label>
                             </div>
                             <div class="plan-option">
                                 <input type="radio" name="teacher-plan" id="teacher-plan-custom-2"
                                     class="visually-hidden">
                                 <label for="teacher-plan-custom-2" class="plan-label">
                                     <div class="custom-plan-text">
                                         <span class="plan-name">Custom plan</span>
                                         <p>Choose the number of <b>lessons</b> if that suits you better.</p>
                                     </div>
                                     <img src="../img/subs/calendar.png" alt="">
                                 </label>
                             </div>
                         </div>
                     </div>
                     <footer class="selection-footer">
                         <button class="checkout-button">Continue to checkout</button>
                     </footer>
                 </section>
                 <div class="confirm-section">
                     <section id="intro">
                         <div class="intro-container">
                             <!--merged image-->
                             <div class="intro-icon-wrapper">
                                 <img src="../img/subs/good-choice.png" alt="icon element">
                             </div>
                             <div class="intro-text">
                                 <h1 class="intro-heading">Good choice. Last step!</h1>
                                 <p class="intro-subheading">Enter your details to confirm your monthly subscription.
                                 </p>
                             </div>
                         </div>
                     </section>
                     <section id="order">
                         <div class="order-container">
                             <h2 class="order-title">Your order</h2>
                             <hr>
                             <div class="order-items-list">
                                 <div class="order-item">
                                     <span class="item-name">6 Months Plan</span>
                                     <span class="item-price">$108.00</span>
                                 </div>
                                 <div class="order-item">
                                     <div class="item-name-with-icon">
                                         <span class="item-name">Taxes &amp; fees</span>
                                         <img src="../img/subs/question-mark.svg" alt="info icon" class="info-icon">
                                     </div>
                                     <span class="item-price">$12.00</span>
                                 </div>
                                 <div class="order-item">
                                     <div class="item-name-with-icon">
                                         <span class="item-name">Your latingles credit</span>
                                         <img src="../img/subs/question-mark.svg" alt="info icon" class="info-icon">
                                     </div>
                                     <span class="item-price">$20.00</span>
                                 </div>
                             </div>
                             <div class="order-total">
                                 <div class="total-row">
                                     <h3 class="total-label">Total</h3>
                                     <span class="total-amount">$120.00</span>
                                 </div>
                                 <span class="total-period">per 6 Month</span>
                             </div>
                             <!-- Promo code row (hidden until "Have a promo code?" is clicked) -->
                             <div class="promo-row" hidden="">
                                 <label class="sr-only" for="promo-input">Promo code</label>
                                 <input id="promo-input" class="promo-input" type="text" inputmode="text"
                                     autocomplete="off" placeholder="Enter promo code">
                                 <button class="promo-apply" type="button">Apply</button>
                             </div>
                             <a href="#" class="promo-link">Have a promo code?</a>
                         </div>
                     </section>
                     <section id="payment">
                         <div class="payment-container">
                             <hr>
                             <div class="payment-details">
                                 <h2 class="payment-title">Payment method</h2>
                                 <div class="payment-selector-container">
                                     <button class="payment-selector" aria-expanded="false" aria-haspopup="listbox">
                                         <div class="card-details">
                                             <img src="../img/subs/visa.png" alt="Visa" class="card-logo">
                                             <span class="card-number">visa****7583</span>
                                         </div>
                                         <img src="../img/subs/arrow-down.svg" alt="dropdown arrow"
                                             class="dropdown-arrow">
                                     </button>
                                     <!-- Payment dropdown menu -->
                                     <ul class="payment-menu" role="listbox" aria-label="Payment methods" hidden="">
                                         <li class="payment-option" role="option" tabindex="-1" data-method="visa"
                                             data-label="visa ****7583">
                                             <span>visa ****7583</span>
                                         </li>
                                         <li class="payment-option" role="option" tabindex="-1" data-method="new-card"
                                             data-label="New Payment Card">
                                             <span>New Payment Card</span>
                                         </li>
                                         <li class="payment-option" role="option" tabindex="-1" data-method="apple-pay"
                                             data-label="Apple Pay">
                                             <span>Apple Pay</span>
                                         </li>
                                         <li class="payment-option" role="option" tabindex="-1" data-method="google-pay"
                                             data-label="Google Pay">
                                             <span>Google Pay</span>
                                         </li>
                                     </ul>
                                 </div>
                                 <!-- New Card form (hidden until 'New Payment Card' selected) -->
                                 <div class="new-card-form" hidden="">
                                     <label>Card Number</label>
                                     <input type="text" placeholder="5218 - 9811 - 4323 - 5216">
                                     <div class="new-card-row">
                                         <div>
                                             <label>Expire Date</label>
                                             <input type="text" placeholder="MM / YYYY">
                                         </div>
                                         <div>
                                             <label>Security Code</label>
                                             <input type="text" placeholder="CVC / CVV">
                                         </div>
                                     </div>
                                 </div>
                                 <!-- Apple Pay button (hidden until Apple Pay selected) -->
                                 <button class="apple-pay-button" hidden=""><img src="../img/subs/apple-pay.svg"
                                         alt="Apple Pay" class="apple-pay-logo"></button>
                                 <!-- Google Pay button (hidden until Google Pay selected) -->
                                 <button class="google-pay-button" hidden=""><img src="../img/subs/google-pay.svg"
                                         alt="Google Pay" class="google-pay-logo"></button>
                                 <button class="confirm-button">Confirm monthly subscription</button>
                                 <p class="policy-text">
                                     By pressing the "Confirm monthly subscription" button, you agree to <a href="#"
                                         class="policy-link">LAtingles’s Refund and Payment Policy</a>.
                                 </p>
                                 <div class="info-box-cancellation">
                                     <img src="../img/subs/check-mark.svg" alt="checkmark" class="info-icon">
                                     <p>You can change your tutor for free or cancel your subscriptioat any time</p>
                                 </div>
                                 <div class="info-box-renewal">
                                     <h3 class="renewal-title">Renews automatically every 6 Months</h3>
                                     <p class="renewal-text">We will charge <strong>$120.00</strong> to your saved
                                         payment method to add <strong>6 Months</strong> plan unless you cancel your
                                         subscription
                                     </p>
                                 </div>
                                 <p class="security-text">It’s safe to pay on Latingles. All transactions are
                                     protected
                                     by SSL encryption.
                                 </p>
                             </div>
                         </div>
                     </section>
                 </div>
                 <section class="plan-summary-panel">
                     <button class="close-button" data-subscribe-close="" aria-label="Close">
                         <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 13 13" fill="none">
                             <path fill-rule="evenodd" clip-rule="evenodd"
                                 d="M1.414 0L0 1.414L4.95 6.364L0 11.314L1.414 12.728L6.364 7.778L11.314 12.728L12.728 11.314L7.778 6.364L12.728 1.414L11.314 0L6.364 4.95L1.414 0Z"
                                 fill="#121117"></path>
                         </svg>
                     </button>
                     <section class="lesson-card-section lesson-card-top">
                         <div class="lesson-card">
                             <div class="card-header-teacher">
                                 <!--merged image-->
                                 <div class="avatar-container">
                                     <img src="../img/subs/2.png" alt="Wade Warren's avatar" class="avatar-image">
                                     <div class="flag-wrapper">
                                         <img src="../img/subs/flag/4.png" alt="Mexico flag" class="country-flag">
                                     </div>
                                 </div>
                                 <div class="tutor-info">
                                     <div class="tutor-info-header">
                                         <h2 class="tutor-name">Wade Warren</h2>
                                         <div class="rating-container">
                                             <img src="../img/subs/star.svg" alt="Star" class="star-icon">
                                             <span class="rating-score">5</span>
                                             <a href="#" class="reviews-link">(3 reviews)</a>
                                         </div>
                                     </div>
                                     <div class="verified-badge">
                                         <img src="../img/subs/verified.png" alt="Verified" class="verified-icon">
                                         <span class="verified-text">Verified</span>
                                     </div>
                                 </div>
                             </div>
                             <div class="lesson-details">
                                 <button><img src="../img/subs/schedule-lesson.png" /> Schedule your next lesson
                                 </button>
                             </div>
                         </div>
                     </section>
                     <div class="summary-card">
                         <div class="summary-header">
                             <h3>Your learning plan</h3>
                             <a href="#" class="link open-faq-modal-teacher">See how our plans work</a>
                         </div>
                         <hr class="separator">
                         <div class="summary-body">
                             <div class="plan-title-section" style="display: block;">
                                 <h4>6 Months Plan</h4>
                                 <p>That’s <b>6 Months Plan at $108.00.</b></p>
                                 <span class="flexible-badge"><img src="${ASSET_PATH}/8160_24684.svg" alt="">Flexible
                                     plan</span>
                             </div>
                             <section id="plan-selector-teacher" hidden="" aria-hidden="true">
                                 <div class="plan-container">
                                     <div class="plan-header-group">
                                         <h2 class="plan-title">How many Months would you like to<br>Select?</h2>
                                         <div class="plan-dropdown" role="button" tabindex="0">
                                             <span class="plan-dropdown-value">12</span>
                                             <img src="../img/subs/arrow-down.svg" alt="Dropdown arrow"
                                                 class="plan-dropdown-arrow">
                                             <section id="pricing-options-teacher" hidden="">
                                                 <div class="pricing-list-container">
                                                     <ul class="pricing-list">
                                                         <li class="pricing-item">
                                                             <span class="item-label">4 Months</span>
                                                             <span class="item-price">$72.00</span>
                                                         </li>
                                                         <li class="pricing-item">
                                                             <span class="item-label">5 Months</span>
                                                             <span class="item-price">$90.00</span>
                                                         </li>
                                                         <li class="pricing-item">
                                                             <span class="item-label">6 Months</span>
                                                             <span class="item-price">$108.00</span>
                                                         </li>
                                                         <li class="pricing-item">
                                                             <span class="item-label">7 Months</span>
                                                             <span class="item-price">$120.00</span>
                                                         </li>
                                                         <li class="pricing-item">
                                                             <span class="item-label">8 Months</span>
                                                             <span class="item-price">$135.00</span>
                                                         </li>
                                                         <li class="pricing-item">
                                                             <span class="item-label">9 Months</span>
                                                             <span class="item-price">$144.00</span>
                                                         </li>
                                                         <li class="pricing-item">
                                                             <span class="item-label">10 Months</span>
                                                             <span class="item-price">$156.00</span>
                                                         </li>
                                                         <li class="pricing-item">
                                                             <span class="item-label">11 Months</span>
                                                             <span class="item-price">$170.00</span>
                                                         </li>
                                                         <li class="pricing-item">
                                                             <span class="item-label">12 Months</span>
                                                             <span class="item-price">$180.00</span>
                                                         </li>
                                                     </ul>
                                                 </div>
                                             </section>
                                         </div>
                                     </div>
                                     <hr class="plan-separator">
                                     <div class="plan-details">
                                         <div class="plan-duration">
                                             <p class="duration-number">12</p>
                                             <p class="duration-label">Months</p>
                                         </div>
                                         <div class="plan-pricing">
                                             <div class="plan-pricing-sub">
                                                 <p class="price-amount">$180.00</p>
                                                 <div class="plan-badge">save 20%</div>
                                             </div>
                                             <p class="price-description">charged per 12 Month</p>
                                         </div>
                                     </div>
                                 </div>
                             </section>
                             <ul class="features-list">
                                 <li class="feature-item">
                                     <div class="feature-icon-wrapper"><img src="../img/subs/calender-1.png" alt="">
                                     </div>
                                     <p>your <b>lessons will be scheduled for 6 Months</b></p>
                                 </li>
                                 <li class="feature-item">
                                     <div class="feature-icon-wrapper"><img src="../img/subs/cap.png" alt=""></div>
                                     <p>Change your tutor <b>for free at any time.</b></p>
                                 </li>
                                 <li class="feature-item">
                                     <div class="feature-icon-wrapper"><img src="../img/subs/stop.png" alt=""></div>
                                     <p>Cancel your plan <b>at any time.</b></p>
                                 </li>
                                 <li class="feature-item">
                                     <div class="feature-icon-wrapper"><img src="../img/subs/clock.png" alt=""></div>
                                     <p>Change the duration of your classes <b>at any time.</b></p>
                                 </li>
                             </ul>
                         </div>
                         <hr class="separator">
                         <section class="lesson-card-section lesson-card-bottom">
                             <div class="lesson-card">
                                 <div class="card-header-teacher">
                                     <!--merged image-->
                                     <div class="avatar-container">
                                         <img src="../img/subs/2.png" alt="Wade Warren's avatar" class="avatar-image">
                                         <div class="flag-wrapper">
                                             <img src="../img/subs/flag/4.png" alt="Mexico flag" class="country-flag">
                                         </div>
                                     </div>
                                     <div class="tutor-info">
                                         <div class="tutor-info-header">
                                             <h2 class="tutor-name">Wade Warren</h2>
                                             <div class="rating-container">
                                                 <img src="../img/subs/star.svg" alt="Star" class="star-icon">
                                                 <span class="rating-score">5</span>
                                                 <a href="#" class="reviews-link">(3 reviews)</a>
                                             </div>
                                         </div>
                                         <div class="verified-badge">
                                             <img src="../img/subs/verified.png" alt="Verified" class="verified-icon">
                                             <span class="verified-text">Verified</span>
                                         </div>
                                     </div>
                                 </div>
                             </div>
                         </section>
                     </div>
                 </section>
             </div>
         </main>
         <!-- Modal + overlay -->
         <div class="modal-overlay" data-faq-overlay-teacher hidden="">
             <div class="modal modal-faq" data-faq="">
                 <button class="modal-close" type="button" aria-label="Close" data-faq-close="">×</button>
                 <h2 id="faq-modal-title" class="modal-title">See how plans works</h2>
                 <div class="faq" data-faq="">
                     <!-- Item -->
                     <section class="faq-item">
                         <h3>
                             <button class="faq-trigger" aria-expanded="false" aria-controls="faq-p1" id="faq-h1">
                                 How to schedule your lessons
                                 <span class="chev" aria-hidden="true"><img src="../img/subs/arrow-down.svg"
                                         alt=""></span>
                             </button>
                         </h3>
                         <div id="faq-p1" class="faq-panel" role="region" aria-labelledby="faq-h1" hidden="">
                             <div class="faq-panel-inner">
                                 Dummy content: Go to “My Lessons”, pick a time slot, and confirm. You’ll receive a
                                 calendar invite and in-app reminder.
                             </div>
                         </div>
                     </section>
                     <!-- Item -->
                     <section class="faq-item">
                         <h3>
                             <button class="faq-trigger" aria-expanded="false" aria-controls="faq-p2" id="faq-h2">
                                 How to change your tutor
                                 <span class="chev" aria-hidden="true"><img src="../img/subs/arrow-down.svg"
                                         alt=""></span>
                             </button>
                         </h3>
                         <div id="faq-p2" class="faq-panel" role="region" aria-labelledby="faq-h2" hidden="">
                             <div class="faq-panel-inner">
                                 Dummy content: From your dashboard, choose “Change tutor”, review suggestions, and
                                 confirm. Your plan and credits carry over.
                             </div>
                         </div>
                     </section>
                     <!-- Item -->
                     <section class="faq-item">
                         <h3>
                             <button class="faq-trigger" aria-expanded="false" aria-controls="faq-p3" id="faq-h3">
                                 How to cancel your plan
                                 <span class="chev" aria-hidden="true"><img src="../img/subs/arrow-down.svg"
                                         alt=""></span>
                             </button>
                         </h3>
                         <div id="faq-p3" class="faq-panel" role="region" aria-labelledby="faq-h3" hidden="">
                             <div class="faq-panel-inner">
                                 Dummy content: Open “Billing &amp; Plan”, click “Cancel plan”, follow the steps, and
                                 you’ll see your end date immediately.
                             </div>
                         </div>
                     </section>
                     <!-- Item -->
                     <section class="faq-item">
                         <h3>
                             <button class="faq-trigger" aria-expanded="false" aria-controls="faq-p4" id="faq-h4">
                                 How to change your renewal date
                                 <span class="chev" aria-hidden="true"><img src="../img/subs/arrow-down.svg"
                                         alt=""></span>
                             </button>
                         </h3>
                         <div id="faq-p4" class="faq-panel" role="region" aria-labelledby="faq-h4" hidden="">
                             <div class="faq-panel-inner">
                                 Dummy content: In “Billing &amp; Plan”, choose “Change renewal”, select a new date,
                                 and
                                 confirm the proration preview.
                             </div>
                         </div>
                     </section>
                     <!-- Item -->
                     <section class="faq-item">
                         <h3>
                             <button class="faq-trigger" aria-expanded="false" aria-controls="faq-p5" id="faq-h5">
                                 How automatic payments work
                                 <span class="chev" aria-hidden="true"><img src="../img/subs/arrow-down.svg"
                                         alt=""></span>
                             </button>
                         </h3>
                         <div id="faq-p5" class="faq-panel" role="region" aria-labelledby="faq-h5" hidden="">
                             <div class="faq-panel-inner">
                                 Dummy content: We charge your saved method on the renewal date. You’ll get a receipt
                                 and can update payment any time.
                             </div>
                         </div>
                     </section>
                 </div>
             </div>
         </div>
     </div>
 </div>


 <script>
// for taechers
(function() {
    // Scoped selectors
    const root = document.querySelector(".subscribe-modal-backdrop-for-teachers");
    if (!root) return;

    const $ = (sel, ctx = root) => ctx.querySelector(sel);
    const $$ = (sel, ctx = root) => Array.from(ctx.querySelectorAll(sel));

    // ====== Elements ======
    const backdrop = document.querySelector(".subscribe-modal-backdrop-for-teachers");
    const openers = document.querySelectorAll(".subscribe-modal-open-teacher"); // optional triggers
    const closeBtns = $$("[data-subscribe-close]");
    const planRadios = $$('input[name="teacher-plan"]');

    // Summary targets
    const summaryTitleEl = $(".plan-title-section h4");
    const summaryLineEl = $(".plan-title-section p b");
    const scheduledP = $(".features-list .feature-item p");

    // Custom selector section
    const customSelector = $("#plan-selector-teacher");
    const customDropdownBtn = customSelector?.querySelector(".plan-dropdown");
    const customDropdownValue = customSelector?.querySelector(".plan-dropdown-value");
    const customDurationNum = customSelector?.querySelector(".plan-details .duration-number");
    const customPriceAmount = customSelector?.querySelector(".plan-pricing .price-amount");
    const customPriceDesc = customSelector?.querySelector(".plan-pricing .price-description");
    const planBadge = customSelector?.querySelector(".plan-pricing .plan-badge");
    const pricingOptions = customSelector?.querySelector("#pricing-options-teacher");

    // ====== Plan map ======
    const PLAN_MAP = {
        "teacher-plan-1": {
            months: 1,
            price: 36.0,
            label: "1 week"
        },
        "teacher-plan-4": {
            months: 4,
            price: 72.0,
            label: "4 weeks"
        },
        "teacher-plan-6": {
            months: 6,
            price: 108.0,
            label: "6 weeks"
        },
        "teacher-plan-9": {
            months: 9,
            price: 144.0,
            label: "9 weeks"
        },
        "teacher-plan-12": {
            months: 12,
            price: 180.0,
            label: "12 weeks"
        },
        "teacher-plan-custom-2": {
            months: null,
            price: null,
            label: "Custom plan"
        },
    };

    // ====== Utils ======
    const money = (n) => `$${Number(n).toFixed(2)}`;
    const parseMonthsFromText = (txt) => {
        const m = String(txt).match(/(\d+)\s*Month/i);
        return m ? Number(m[1]) : null;
    };
    const parsePriceFromText = (txt) => {
        const clean = String(txt).replace(/[^\d.]/g, "");
        return clean ? Number(clean) : null;
    };

    // ====== Modal controls ======
    function openModal() {
        backdrop?.classList.add("is-open");
        document.body.style.overflow = "hidden";
    }

    function closeModal() {
        backdrop?.classList.remove("is-open");
        document.body.style.overflow = "";
        closePricingOptions();
    }

    openers.forEach((btn) =>
        btn.addEventListener("click", (e) => {
            e.preventDefault();
            openModal();
        })
    );
    closeBtns.forEach((btn) =>
        btn.addEventListener("click", () => closeModal())
    );
    backdrop?.addEventListener("click", (e) => {
        if (e.target === backdrop) closeModal();
    });
    document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") {
            if (isPricingOpen()) closePricingOptions();
            else closeModal();
        }
    });

    // ====== Pricing dropdown ======
    function isPricingOpen() {
        return pricingOptions?.classList.contains("is-open");
    }

    function openPricingOptions() {
        if (!pricingOptions) return;
        pricingOptions.hidden = false;
        pricingOptions.classList.add("is-open");
        document.addEventListener("click", outsideCloseHandler, {
            capture: true
        });
    }

    function closePricingOptions() {
        if (!pricingOptions) return;
        pricingOptions.hidden = true;
        pricingOptions.classList.remove("is-open");
        document.removeEventListener("click", outsideCloseHandler, {
            capture: true
        });
    }

    function togglePricingOptions() {
        isPricingOpen() ? closePricingOptions() : openPricingOptions();
    }

    function outsideCloseHandler(e) {
        const clickInsideList = pricingOptions?.contains(e.target);
        const clickOnButton = customDropdownBtn?.contains(e.target);
        if (!clickInsideList && !clickOnButton) closePricingOptions();
    }

    customDropdownBtn?.addEventListener("click", (e) => {
        e.preventDefault();
        togglePricingOptions();
    });

    pricingOptions?.addEventListener("click", (e) => {
        const item = e.target.closest(".pricing-item");
        if (!item) return;

        e.preventDefault();
        e.stopPropagation();

        const labelEl = item.querySelector(".item-label");
        const priceEl = item.querySelector(".item-price");

        const months = parseMonthsFromText(labelEl?.textContent || "");
        const price = parsePriceFromText(priceEl?.textContent || "");
        if (!months || !price) return;

        if (customDropdownValue) customDropdownValue.textContent = String(months);
        if (customDurationNum) customDurationNum.textContent = String(months);
        if (customPriceAmount) customPriceAmount.textContent = money(price);
        if (customPriceDesc) customPriceDesc.textContent = `charged per ${months} Month`;

        const customRadio = $("#plan-custom-2");
        if (customRadio && !customRadio.checked) {
            customRadio.checked = true;
            syncCustomVisibility("plan-custom-2");
        }

        updateSummaryCustom(months, price);
        requestAnimationFrame(closePricingOptions);
    });

    // ====== Show/hide custom selector ======
    function openCustom() {
        if (!customSelector) return;
        customSelector.hidden = false;
        $(".plan-title-section").style.display = "none";
        $("lesson-card-top").style.display = "none"
    }

    function closeCustom() {
        if (!customSelector) return;
        customSelector.hidden = true;
        $(".plan-title-section").style.display = "block";
        closePricingOptions();
    }

    function syncCustomVisibility(planId) {
        if (planId === "teacher-plan-custom-2") openCustom();
        else closeCustom();
    }

    // ====== Summary ======
    function updateSummaryCustom(months, price) {
        if (summaryTitleEl) summaryTitleEl.textContent = `${months} Months Plan`;
        if (summaryLineEl) summaryLineEl.textContent = `${months} Months Plan at ${money(price)}.`;
        if (scheduledP) {
            scheduledP.innerHTML = scheduledP.innerHTML.replace(
                /scheduled for <b>.*?<\/b>/,
                `scheduled for <b>${months} Months</b>`
            );
        }
    }

    function updateSummaryById(planId) {
        const plan = PLAN_MAP[planId];
        if (!plan) return;

        if (planId === "teacher-plan-custom-2") {
            const months = parseInt(customDurationNum?.textContent || "", 10);
            const price = parsePriceFromText(customPriceAmount?.textContent || "");
            if (months && price) updateSummaryCustom(months, price);
            return;
        }

        const {
            months,
            price,
            label
        } = plan;
        if (summaryTitleEl) summaryTitleEl.textContent = `${label} Plan`;
        if (summaryLineEl) summaryLineEl.textContent = `${label} Plan at ${money(price)}.`;
        if (scheduledP) {
            scheduledP.innerHTML = scheduledP.innerHTML.replace(
                /scheduled for <b>.*?<\/b>/,
                `scheduled for <b>${months} Months</b>`
            );
        }
    }

    // ====== Radios ======
    planRadios.forEach((r) => {
        r.addEventListener("change", () => {
            if (r.checked) {
                updateSummaryById(r.id);
                syncCustomVisibility(r.id);
            }
        });
    });

    const initial = planRadios.find((r) => r.checked) || planRadios[0];
    if (initial) {
        updateSummaryById(initial.id);
        syncCustomVisibility(initial.id);
    } else {
        closeCustom();
    }

    // ====== Checkout flow ======
    const checkoutBtn = $(".checkout-button");
    const confirmModal = $(".confirm-section");
    const planSelectionModal = $(".plan-selection-panel");
    const lessonCardTop = $(".lesson-card-top")
    const lessonCardBottom = $(".lesson-card-bottom")
    if (checkoutBtn && confirmModal && planSelectionModal) {
        checkoutBtn.addEventListener("click", (e) => {
            e.preventDefault();
            confirmModal.style.display = "flex";
            planSelectionModal.style.display = "none";
            lessonCardTop.style.display = "none"
            lessonCardBottom.style.display = "block"
        });
    }


    const openBtn = document.querySelector(".open-faq-modal-group");
    const overlay = document.querySelector("[data-faq-overlay-group]");
    const modal = overlay?.querySelector(".modal");
    const closeBtn = overlay?.querySelector("[data-faq-close]");
    const triggers = Array.from(overlay?.querySelectorAll(".faq-trigger") || []);

    if (!openBtn || !overlay || !modal || !closeBtn) return;

    // --- Modal open/close with focus trap
    let lastFocused = null;

    function openModalSub() {
        lastFocused = document.activeElement;
        overlay.hidden = false;
        modal.setAttribute("data-anim", "in");
        // focus first interactive element
        (closeBtn || modal).focus();

        document.addEventListener("keydown", onKeydown);
        document.addEventListener("focus", trapFocus, true);
        overlay.addEventListener("click", onOverlayClick);
    }

    function closeModalSub() {
        modal.setAttribute("data-anim", "out");
        // wait for animation end then hide
        const done = () => {
            overlay.hidden = true;
            modal.removeAttribute("data-anim");
            document.removeEventListener("keydown", onKeydown);
            document.removeEventListener("focus", trapFocus, true);
            overlay.removeEventListener("click", onOverlayClick);
            if (lastFocused) lastFocused.focus();
            modal.removeEventListener("animationend", done);
        };
        modal.addEventListener("animationend", done);
    }

    function onOverlayClick(e) {
        if (e.target === overlay) closeModalSub();
    }

    function onKeydown(e) {
        if (e.key === "Escape") {
            e.preventDefault();
            closeModal();
        }
        if (e.key === "Tab") {
            // simple focus trap: keep focus inside modal
            const focusables = modal.querySelectorAll(
                'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
            );
            const list = Array.from(focusables).filter(
                (el) => !el.hasAttribute("disabled")
            );
            if (!list.length) return;

            const first = list[0];
            const last = list[list.length - 1];

            if (e.shiftKey && document.activeElement === first) {
                e.preventDefault();
                last.focus();
            } else if (!e.shiftKey && document.activeElement === last) {
                e.preventDefault();
                first.focus();
            }
        }
    }

    function trapFocus(e) {
        if (!overlay.hidden && !modal.contains(e.target)) {
            e.stopPropagation();
            (closeBtn || modal).focus();
        }
    }

    openBtn.addEventListener("click", openModalSub);
    closeBtn.addEventListener("click", closeModal);

    // --- FAQ accordion behavior with animation
    triggers.forEach((btn) => {
        btn.addEventListener("click", () => togglePanel(btn));
        btn.addEventListener("keydown", (e) => {
            if (e.key === "Enter" || e.key === " ") {
                e.preventDefault();
                togglePanel(btn);
            }
        });
    });

    function togglePanel(btn) {
        const panelId = btn.getAttribute("aria-controls");
        const panel = document.getElementById(panelId);
        const expanded = btn.getAttribute("aria-expanded") === "true";

        if (expanded) {
            // Close clicked
            btn.setAttribute("aria-expanded", "false");
            panel.classList.remove("open");

            // Wait until transition ends, then hide
            panel.addEventListener(
                "transitionend",
                () => {
                    if (!panel.classList.contains("open")) {
                        panel.hidden = true;
                    }
                }, {
                    once: true
                }
            );
        } else {
            // Close ALL others first
            triggers.forEach((otherBtn) => {
                const otherId = otherBtn.getAttribute("aria-controls");
                const otherPanel = document.getElementById(otherId);

                if (otherBtn !== btn) {
                    otherBtn.setAttribute("aria-expanded", "false");
                    otherPanel.classList.remove("open");
                    otherPanel.addEventListener(
                        "transitionend",
                        () => {
                            if (!otherPanel.classList.contains("open")) {
                                otherPanel.hidden = true;
                            }
                        }, {
                            once: true
                        }
                    );

                    const chev = otherBtn.querySelector(".chev");
                    if (chev) chev.style.transform = "rotate(0deg)";
                }
            });

            // Open clicked
            panel.hidden = false; // make sure it's visible before animating
            requestAnimationFrame(() => panel.classList.add("open"));
            btn.setAttribute("aria-expanded", "true");
        }

        // Chevron update
        const chev = btn.querySelector(".chev");
        if (chev)
            chev.style.transform = expanded ? "rotate(0deg)" : "rotate(180deg)";
    }


})();
 </script>