define ("atto_subtitle/previewhelper",["jquery","atto_subtitle/constants"],function(a,b){return{controls:{},activeSubtitle:-1,ss:null,mediatype:b.mediatype_video,init:function init(a,b){this.ss=a;this.mediatype=b;this.initControls();this.initEvents()},initControls:function initControls(){this.controls.videoplayer=a(b.videoplayer);this.controls.audioplayer=a(b.audioplayer);this.controls.root=a(b.root);if(this.mediatype===b.mediatype_audio){this.controls.mediaplayer=this.controls.audioplayer}else{this.controls.mediaplayer=this.controls.videoplayer}this.controls.mediaplayer.show();this.controls.previewline=a(b.previewline)},initEvents:function initEvents(){var a=this;this.controls.mediaplayer.on("timeupdate",function(){var b=a.fetchCurrentTime(),c=a.ss.fetchItemByTime(b);if(!1===c){a.deactivateAll()}else{if(a.activeSubtitle!==c){a.activateSubtitle(c)}}})},setPosition:function setPosition(a){var b=this.ss.fetchItem(a);if(!b){return}this.controls.mediaplayer[0].pause();var c=(b.start/1e3).toFixed(3);this.controls.mediaplayer[0].currentTime=c},updateLabel:function updateLabel(){if(-1<this.activeSubtitle){this.activateSubtitle(this.activeSubtitle)}},fetchCurrentTime:function fetchCurrentTime(){return Math.floor(1e3*this.controls.mediaplayer[0].currentTime)},setMediaURL:function setMediaURL(a){if(!a|1>a.length){return}switch(this.mediatype){case b.mediatype_audio:this.mediatype=b.mediatype_audio;this.controls.mediaplayer.off("timeupdate");this.controls.mediaplayer=this.controls.audioplayer;this.initEvents();this.controls.root.addClass("player-audio");break;default:this.mediatype=b.mediatype_video;this.controls.mediaplayer.off("timeupdate");this.controls.mediaplayer=this.controls.videoplayer;this.initEvents();this.controls.root.removeClass("player-audio");}for(var c=0,d;c<a.length;c++){d="<source src=\""+a[c]+"\">";this.controls.mediaplayer.prepend(d)}this.controls.mediaplayer[0].load()},activateSubtitle:function activateSubtitle(a){this.highlightItem(a);this.activeSubtitle=a;var b=this.ss.fetchItem(a);if(b){this.controls.previewline.text(b.part);this.controls.previewline.show()}else{this.deactivateAll()}},deactivateAll:function deactivateAll(){this.deHighlightAll();this.activeSubtitle=-1;this.controls.previewline.text("")},highlightItem:function highlightItem(){},deHighlightAll:function deHighlightAll(){}}});
//# sourceMappingURL=previewhelper.min.js.map
